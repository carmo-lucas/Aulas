<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>5.1 Regressões Lineares | Aulas de R</title>
  <meta name="description" content="5.1 Regressões Lineares | Aulas de R" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="5.1 Regressões Lineares | Aulas de R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="5.1 Regressões Lineares | Aulas de R" />
  
  
  

<meta name="author" content="Lucas Chagas Lima do Carmo" />


<meta name="date" content="2020-04-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="regressões.html"/>
<link rel="next" href="references.html"/>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introdução</a></li>
<li class="chapter" data-level="1" data-path="tipos-de-dados.html"><a href="tipos-de-dados.html"><i class="fa fa-check"></i><b>1</b> Tipos de Dados</a></li>
<li class="chapter" data-level="2" data-path="extensões.html"><a href="extensões.html"><i class="fa fa-check"></i><b>2</b> Extensões</a><ul>
<li class="chapter" data-level="2.1" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>2.1</b> <code>tidyverse</code></a><ul>
<li class="chapter" data-level="2.1.1" data-path="tidyverse.html"><a href="tidyverse.html#dplyr"><i class="fa fa-check"></i><b>2.1.1</b> <code>dplyr</code></a></li>
<li class="chapter" data-level="2.1.2" data-path="tidyverse.html"><a href="tidyverse.html#tidyr"><i class="fa fa-check"></i><b>2.1.2</b> <code>tidyr</code></a></li>
<li class="chapter" data-level="2.1.3" data-path="tidyverse.html"><a href="tidyverse.html#readr"><i class="fa fa-check"></i><b>2.1.3</b> <code>readr</code></a></li>
<li class="chapter" data-level="2.1.4" data-path="tidyverse.html"><a href="tidyverse.html#stringr"><i class="fa fa-check"></i><b>2.1.4</b> <code>stringr</code></a></li>
<li class="chapter" data-level="2.1.5" data-path="tidyverse.html"><a href="tidyverse.html#tibble"><i class="fa fa-check"></i><b>2.1.5</b> <code>tibble</code></a></li>
<li class="chapter" data-level="2.1.6" data-path="tidyverse.html"><a href="tidyverse.html#purrr"><i class="fa fa-check"></i><b>2.1.6</b> <code>purrr</code></a></li>
<li class="chapter" data-level="2.1.7" data-path="tidyverse.html"><a href="tidyverse.html#forcats"><i class="fa fa-check"></i><b>2.1.7</b> <code>forcats</code></a></li>
<li class="chapter" data-level="2.1.8" data-path="tidyverse.html"><a href="tidyverse.html#magrittr"><i class="fa fa-check"></i><b>2.1.8</b> <code>magrittr</code></a></li>
<li class="chapter" data-level="2.1.9" data-path="tidyverse.html"><a href="tidyverse.html#ggplot2"><i class="fa fa-check"></i><b>2.1.9</b> <code>ggplot2</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="operadores.html"><a href="operadores.html"><i class="fa fa-check"></i><b>3</b> Operadores</a><ul>
<li class="chapter" data-level="3.1" data-path="operadores-aritméticos.html"><a href="operadores-aritméticos.html"><i class="fa fa-check"></i><b>3.1</b> Operadores aritméticos</a><ul>
<li class="chapter" data-level="3.1.1" data-path="operadores-aritméticos.html"><a href="operadores-aritméticos.html#exemplos"><i class="fa fa-check"></i><b>3.1.1</b> Exemplos</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="operadores-lógicos.html"><a href="operadores-lógicos.html"><i class="fa fa-check"></i><b>3.2</b> Operadores Lógicos</a><ul>
<li class="chapter" data-level="3.2.1" data-path="operadores-lógicos.html"><a href="operadores-lógicos.html#exemplos-1"><i class="fa fa-check"></i><b>3.2.1</b> Exemplos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ggplot2-1.html"><a href="ggplot2-1.html"><i class="fa fa-check"></i><b>4</b> <code>ggplot2</code></a><ul>
<li class="chapter" data-level="4.1" data-path="gramática-de-gráficos.html"><a href="gramática-de-gráficos.html"><i class="fa fa-check"></i><b>4.1</b> Gramática de Gráficos</a></li>
<li class="chapter" data-level="4.2" data-path="instalação.html"><a href="instalação.html"><i class="fa fa-check"></i><b>4.2</b> Instalação</a></li>
<li class="chapter" data-level="4.3" data-path="componentes-principais-dos-gráficos.html"><a href="componentes-principais-dos-gráficos.html"><i class="fa fa-check"></i><b>4.3</b> Componentes principais dos gráficos</a></li>
<li class="chapter" data-level="4.4" data-path="cores-tamanhos-formas-e-outros-atributos-estéticos.html"><a href="cores-tamanhos-formas-e-outros-atributos-estéticos.html"><i class="fa fa-check"></i><b>4.4</b> Cores, tamanhos, formas e outros atributos estéticos</a></li>
<li class="chapter" data-level="4.5" data-path="geoms.html"><a href="geoms.html"><i class="fa fa-check"></i><b>4.5</b> Geoms</a><ul>
<li class="chapter" data-level="4.5.1" data-path="geoms.html"><a href="geoms.html#geoms-individuais"><i class="fa fa-check"></i><b>4.5.1</b> Geoms individuais</a></li>
<li class="chapter" data-level="4.5.2" data-path="geoms.html"><a href="geoms.html#geoms-coletivos"><i class="fa fa-check"></i><b>4.5.2</b> Geoms coletivos</a></li>
<li class="chapter" data-level="4.5.3" data-path="geoms.html"><a href="geoms.html#resumos-estatísticos"><i class="fa fa-check"></i><b>4.5.3</b> Resumos estatísticos</a></li>
<li class="chapter" data-level="4.5.4" data-path="geoms.html"><a href="geoms.html#resolvendo-overplotting"><i class="fa fa-check"></i><b>4.5.4</b> Resolvendo <em>overplotting</em></a></li>
<li class="chapter" data-level="4.5.5" data-path="geoms.html"><a href="geoms.html#anotações"><i class="fa fa-check"></i><b>4.5.5</b> Anotações</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="regressões.html"><a href="regressões.html"><i class="fa fa-check"></i><b>5</b> Regressões</a><ul>
<li class="chapter" data-level="5.1" data-path="regressões-lineares.html"><a href="regressões-lineares.html"><i class="fa fa-check"></i><b>5.1</b> Regressões Lineares</a><ul>
<li class="chapter" data-level="5.1.1" data-path="regressões-lineares.html"><a href="regressões-lineares.html#método-de-função"><i class="fa fa-check"></i><b>5.1.1</b> Método de função</a></li>
<li class="chapter" data-level="5.1.2" data-path="regressões-lineares.html"><a href="regressões-lineares.html#método-ggplot2"><i class="fa fa-check"></i><b>5.1.2</b> Método <code>ggplot2</code></a></li>
<li class="chapter" data-level="5.1.3" data-path="regressões-lineares.html"><a href="regressões-lineares.html#método-ggpmisc"><i class="fa fa-check"></i><b>5.1.3</b> Método <code>ggpmisc</code></a></li>
<li class="chapter" data-level="5.1.4" data-path="regressões-lineares.html"><a href="regressões-lineares.html#método-ggpubr"><i class="fa fa-check"></i><b>5.1.4</b> Método <code>ggpubr</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Aulas de R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regressões-lineares" class="section level2">
<h2><span class="header-section-number">5.1</span> Regressões Lineares</h2>
<p>No <code>R</code> para criar modelos lineares simples é usada a função <code>lm()</code>.
Os principais argumentos são a <code>formula</code> e os dasos (<code>data</code>), você pode ler os outros argumentos usando rodando <code>?lm()</code> no console.
Então para montar um modelo de regressão limples é apenas necessário ter um dataframe com uma coluna com os valores de <code>x</code> e uma coluna com os valores de <code>y</code>.
Iremos usar os dados do dataset <code>mpg</code> para criar exemplos.</p>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb124-1" title="1">fit &lt;-<span class="st"> </span><span class="kw">lm</span>(cty <span class="op">~</span><span class="st"> </span>displ, <span class="dt">data =</span> mpg)</a>
<a class="sourceLine" id="cb124-2" title="2"></a>
<a class="sourceLine" id="cb124-3" title="3"><span class="kw">print</span>(fit)</a></code></pre></div>
<pre><code>
Call:
lm(formula = cty ~ displ, data = mpg)

Coefficients:
(Intercept)        displ  
      25.99        -2.63  </code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb126-1" title="1"><span class="kw">class</span>(fit)</a></code></pre></div>
<pre><code>[1] &quot;lm&quot;</code></pre>
<p>O resultado obtidos são o coeficientes de <em>Intercept</em> que é o coeficiente linear da reta e o outro coeficiente que tem o nome da variável é o coeficiente angular da reta.
A função <code>print()</code> mostra apenas estes valores mas podemos acessar mais valores do modelo usando outras funções ou métodos.</p>
<p>Observamos também que a classe do objeto <code>fit</code> que foi criado é <code>lm</code>, portanto qualquer função que tenha como acessar os dados contidos em objetos de classe <code>lm</code> podem ser usadas, por exemplo <code>summary()</code></p>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb128-1" title="1"><span class="kw">summary</span>(fit)</a></code></pre></div>
<pre><code>
Call:
lm(formula = cty ~ displ, data = mpg)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.3109 -1.4695 -0.2566  1.1087 14.0064 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  25.9915     0.4821   53.91   &lt;2e-16 ***
displ        -2.6305     0.1302  -20.20   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.567 on 232 degrees of freedom
Multiple R-squared:  0.6376,    Adjusted R-squared:  0.6361 
F-statistic: 408.2 on 1 and 232 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Usando a função <code>summary()</code> obtemos vários valores que podem não ter muito significado quando o interesse é verificar o coeficiente de determinação (<span class="math inline">\(R^2\)</span>) de um modelo, inclusive a função <code>summary()</code> retorna este valor mas também dados sobre a distribuição de residuais, erro dos coeficientes e outros valores estatísticos.
Inclusive podemos visualizar estes dados usando a função <code>plot()</code> de base que consegue gerar vários gráficos apenas com o objeto de classe <code>lm</code>.</p>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb130-1" title="1"><span class="kw">plot</span>(fit)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-25-1.png" width="2100" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-25-2.png" width="2100" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-25-3.png" width="2100" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-25-4.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Porém para o uso em questão isso não é extremamente relevante porque não estamos buscando avaliar a normalidade da distribuição e sim verificar se o modelo é adequado para uma curva de calibração.</p>
<p>Neste caso iremos gerar dados simulados para calcular um novo modelo:</p>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="co"># concentração de 0 a 20</span></a>
<a class="sourceLine" id="cb131-2" title="2">conc &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb131-3" title="3"></a>
<a class="sourceLine" id="cb131-4" title="4"><span class="co"># absorbância é igual a 2x a concentração mais um valor entre 0,5 e 1</span></a>
<a class="sourceLine" id="cb131-5" title="5">abs  =<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>conc <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> <span class="kw">length</span>(conc), <span class="dt">min =</span> <span class="fl">0.5</span>, <span class="dt">max =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb131-6" title="6"></a>
<a class="sourceLine" id="cb131-7" title="7">calibracao &lt;-<span class="st"> </span><span class="kw">data.frame</span>(conc, abs)</a>
<a class="sourceLine" id="cb131-8" title="8"></a>
<a class="sourceLine" id="cb131-9" title="9">calibracao</a></code></pre></div>
<pre><code>   conc       abs
1     0  1.016677
2     1  3.458888
3     2  4.916594
4     3  6.645072
5     4  8.604362
6     5 11.917697
7     6 13.233665
8     7 14.683449
9     8 17.405774
10    9 19.370644
11   10 21.183999
12   11 22.851815
13   12 25.451773
14   13 27.733185
15   14 29.117185
16   15 30.570186
17   16 32.615775
18   17 35.688068
19   18 37.505108
20   19 39.689281
21   20 41.615462</code></pre>
<p>Com os dados gerados podemos gerar o modelo linear para os dados de <code>calibracao</code>.</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1">fit_calib &lt;-<span class="st"> </span><span class="kw">lm</span>(abs <span class="op">~</span><span class="st"> </span>conc, <span class="dt">data =</span> calibracao)</a>
<a class="sourceLine" id="cb133-2" title="2"></a>
<a class="sourceLine" id="cb133-3" title="3"><span class="kw">summary</span>(fit_calib)</a></code></pre></div>
<pre><code>
Call:
lm(formula = abs ~ conc, data = calibracao)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.7350 -0.3721  0.1114  0.2429  0.8158 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.0002     0.1766   5.665 1.84e-05 ***
conc          2.0203     0.0151 133.776  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4191 on 19 degrees of freedom
Multiple R-squared:  0.9989,    Adjusted R-squared:  0.9989 
F-statistic: 1.79e+04 on 1 and 19 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Como esperado, o coeficiente angular é de aproximadamente 2 e o coeficiente linear que deveria ser 0 é de 1.0002065.
Como todos os objetos, o objeto da classe <code>lm</code> possui uma estrutura.
Podemos ver esta estrutura usando a função <code>str()</code>, que retorna a estrutura completa dos objetos, porém de uma forma não muito fácil de entender</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb135-1" title="1"><span class="kw">str</span>(fit_calib)</a></code></pre></div>
<pre><code>List of 12
 $ coefficients : Named num [1:2] 1 2.02
  ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;(Intercept)&quot; &quot;conc&quot;
 $ residuals    : Named num [1:21] 0.0165 0.4383 -0.1243 -0.4161 -0.4772 ...
  ..- attr(*, &quot;names&quot;)= chr [1:21] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
 $ effects      : Named num [1:21] -97.167 56.062 -0.205 -0.484 -0.533 ...
  ..- attr(*, &quot;names&quot;)= chr [1:21] &quot;(Intercept)&quot; &quot;conc&quot; &quot;&quot; &quot;&quot; ...
 $ rank         : int 2
 $ fitted.values: Named num [1:21] 1 3.02 5.04 7.06 9.08 ...
  ..- attr(*, &quot;names&quot;)= chr [1:21] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
 $ assign       : int [1:2] 0 1
 $ qr           :List of 5
  ..$ qr   : num [1:21, 1:2] -4.583 0.218 0.218 0.218 0.218 ...
  .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. ..$ : chr [1:21] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
  .. .. ..$ : chr [1:2] &quot;(Intercept)&quot; &quot;conc&quot;
  .. ..- attr(*, &quot;assign&quot;)= int [1:2] 0 1
  ..$ qraux: num [1:2] 1.22 1.26
  ..$ pivot: int [1:2] 1 2
  ..$ tol  : num 1e-07
  ..$ rank : int 2
  ..- attr(*, &quot;class&quot;)= chr &quot;qr&quot;
 $ df.residual  : int 19
 $ xlevels      : Named list()
 $ call         : language lm(formula = abs ~ conc, data = calibracao)
 $ terms        :Classes &#39;terms&#39;, &#39;formula&#39;  language abs ~ conc
  .. ..- attr(*, &quot;variables&quot;)= language list(abs, conc)
  .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
  .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. .. ..$ : chr [1:2] &quot;abs&quot; &quot;conc&quot;
  .. .. .. ..$ : chr &quot;conc&quot;
  .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;conc&quot;
  .. ..- attr(*, &quot;order&quot;)= int 1
  .. ..- attr(*, &quot;intercept&quot;)= int 1
  .. ..- attr(*, &quot;response&quot;)= int 1
  .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
  .. ..- attr(*, &quot;predvars&quot;)= language list(abs, conc)
  .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
  .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;abs&quot; &quot;conc&quot;
 $ model        :&#39;data.frame&#39;:  21 obs. of  2 variables:
  ..$ abs : num [1:21] 1.02 3.46 4.92 6.65 8.6 ...
  ..$ conc: int [1:21] 0 1 2 3 4 5 6 7 8 9 ...
  ..- attr(*, &quot;terms&quot;)=Classes &#39;terms&#39;, &#39;formula&#39;  language abs ~ conc
  .. .. ..- attr(*, &quot;variables&quot;)= language list(abs, conc)
  .. .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
  .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. .. .. ..$ : chr [1:2] &quot;abs&quot; &quot;conc&quot;
  .. .. .. .. ..$ : chr &quot;conc&quot;
  .. .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;conc&quot;
  .. .. ..- attr(*, &quot;order&quot;)= int 1
  .. .. ..- attr(*, &quot;intercept&quot;)= int 1
  .. .. ..- attr(*, &quot;response&quot;)= int 1
  .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, &quot;predvars&quot;)= language list(abs, conc)
  .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
  .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;abs&quot; &quot;conc&quot;
 - attr(*, &quot;class&quot;)= chr &quot;lm&quot;</code></pre>
<p>Mas o que podemos observar é que o objeto é uma lista com 12 elementos então podemos acessar estes elementos através de seus índices ou de seus nomes.</p>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb137-1" title="1"><span class="co"># coeficientes</span></a>
<a class="sourceLine" id="cb137-2" title="2">fit_calib<span class="op">$</span>coefficients</a></code></pre></div>
<pre><code>(Intercept)        conc 
   1.000206    2.020335 </code></pre>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb139-1" title="1"><span class="co"># residuais</span></a>
<a class="sourceLine" id="cb139-2" title="2">fit_calib<span class="op">$</span>residuals</a></code></pre></div>
<pre><code>          1           2           3           4           5           6 
 0.01647084  0.43834658 -0.12428242 -0.41613929 -0.47718346  0.81581603 
          7           8           9          10          11          12 
 0.11144940 -0.45910164  0.24288861  0.18742329 -0.01955626 -0.37207511 
         13          14          15          16          17          18 
 0.20754793  0.46862511 -0.16770942 -0.73504385 -0.70978908  0.34216835 
         19          20          21 
 0.13887431  0.30271240  0.20855767 </code></pre>
<p>E para acessar elementos específicos destas listas usamos os operadores <code>[ ]</code></p>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb141-1" title="1"><span class="co"># coeficiente linear (intercept)</span></a>
<a class="sourceLine" id="cb141-2" title="2">fit_calib<span class="op">$</span>coefficients[<span class="dv">1</span>]</a></code></pre></div>
<pre><code>(Intercept) 
   1.000206 </code></pre>
<div class="sourceCode" id="cb143"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb143-1" title="1"><span class="co"># coeficiente angular</span></a>
<a class="sourceLine" id="cb143-2" title="2">fit_calib<span class="op">$</span>coefficients[<span class="dv">2</span>]</a></code></pre></div>
<pre><code>    conc 
2.020335 </code></pre>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb145-1" title="1"><span class="co"># valor do coeficiente linear (intercept)</span></a>
<a class="sourceLine" id="cb145-2" title="2">fit_calib<span class="op">$</span>coefficients[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>[1] 1.000206</code></pre>
<div class="sourceCode" id="cb147"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb147-1" title="1"><span class="co"># valor do coeficiente angular</span></a>
<a class="sourceLine" id="cb147-2" title="2">fit_calib<span class="op">$</span>coefficients[[<span class="dv">2</span>]]</a></code></pre></div>
<pre><code>[1] 2.020335</code></pre>
<div class="sourceCode" id="cb149"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb149-1" title="1"><span class="co"># R quadrado</span></a>
<a class="sourceLine" id="cb149-2" title="2"><span class="kw">summary</span>(fit_calib)<span class="op">$</span>r.squared</a></code></pre></div>
<pre><code>[1] 0.9989394</code></pre>
<p>Claro que parece muito complicado ter que fazer tudo isso para extrair alguns dados e mesmo assim, existem várias formas de extraí-los o que causa muita confusão, portanto iremos explorar alguns métodos para extraír estes dados do objeto <code>lm()</code>.</p>
<div id="método-de-função" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Método de função</h3>
<p>É fundamental em qualquer linguagem de programação que se saiba escrever funções que facilitem seu trabalho e deixem o código mais simples.
Neste documento não estão escritas necessariamente as melhores funções que são mais eficientes mas aquelas que funcionam para o que é desejado. Na grande maioria das vezes é melhor escrever uma função rápido do que escrever uma função que funcione rápido.
Otimização de código não é a nossa prioridade agora.</p>
<p>Em outro capítulo será explorado a criação de funções melhor mas agora iremos apenas usar lógica para criar uma função que extraia os dados de coeficiente linear, angular, e <span class="math inline">\(R^2\)</span> e coloque-os em um dataframe com os nomes e os valores usando a sintaxe já demonstrada.</p>
<div class="sourceCode" id="cb151"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb151-1" title="1">extrair &lt;-<span class="st"> </span><span class="cf">function</span>(fit) { <span class="co">#fit é o argumento desta função</span></a>
<a class="sourceLine" id="cb151-2" title="2">    </a>
<a class="sourceLine" id="cb151-3" title="3">    <span class="co"># cria variável que contém coeficiente linear</span></a>
<a class="sourceLine" id="cb151-4" title="4">    coef_lin &lt;-<span class="st"> </span>fit<span class="op">$</span>coefficients[[<span class="dv">1</span>]]</a>
<a class="sourceLine" id="cb151-5" title="5">    <span class="co"># cria variável que contém coeficiente angular</span></a>
<a class="sourceLine" id="cb151-6" title="6">    coef_ang &lt;-<span class="st"> </span>fit<span class="op">$</span>coefficients[[<span class="dv">2</span>]]</a>
<a class="sourceLine" id="cb151-7" title="7">    <span class="co"># cria variável que contém r quadrado</span></a>
<a class="sourceLine" id="cb151-8" title="8">    r_quadrado &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb151-9" title="9">    </a>
<a class="sourceLine" id="cb151-10" title="10">    <span class="co"># cria dataframe com os dados em cada coluna</span></a>
<a class="sourceLine" id="cb151-11" title="11">    tabela &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</a>
<a class="sourceLine" id="cb151-12" title="12">        <span class="st">&quot;Coeficiente Linear&quot;</span> =<span class="st"> </span>coef_lin,</a>
<a class="sourceLine" id="cb151-13" title="13">        <span class="st">&quot;Coeficiente Angular&quot;</span> =<span class="st"> </span>coef_ang,</a>
<a class="sourceLine" id="cb151-14" title="14">        <span class="st">&quot;R quadrado&quot;</span> =<span class="st"> </span>r_quadrado</a>
<a class="sourceLine" id="cb151-15" title="15">        )</a>
<a class="sourceLine" id="cb151-16" title="16">    </a>
<a class="sourceLine" id="cb151-17" title="17">    <span class="co"># pede para a função retornar o dataframe como output</span></a>
<a class="sourceLine" id="cb151-18" title="18">    <span class="kw">return</span>(tabela)</a>
<a class="sourceLine" id="cb151-19" title="19">    </a>
<a class="sourceLine" id="cb151-20" title="20">}</a>
<a class="sourceLine" id="cb151-21" title="21"></a>
<a class="sourceLine" id="cb151-22" title="22"><span class="co"># usando função nos dados de calibração</span></a>
<a class="sourceLine" id="cb151-23" title="23"><span class="kw">extrair</span>(fit_calib)</a></code></pre></div>
<pre><code>  Coeficiente.Linear Coeficiente.Angular R.quadrado
1           1.000206            2.020335  0.9989394</code></pre>
<div class="sourceCode" id="cb153"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb153-1" title="1"><span class="co"># usando função nos dados de mpg</span></a>
<a class="sourceLine" id="cb153-2" title="2"><span class="kw">extrair</span>(fit)</a></code></pre></div>
<pre><code>  Coeficiente.Linear Coeficiente.Angular R.quadrado
1           25.99147           -2.630482  0.6376405</code></pre>
<p>Agora esta função pode ser usada sempe que se desejar extrair estes dados de um modelo linear criado com <code>lm()</code>.
Não é a função mais robusta e alguns erros podem surgir quando tentando combinar ela com outras operações, mas para uma introdução funciona muito bem.</p>
</div>
<div id="método-ggplot2" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Método <code>ggplot2</code></h3>
<p>Um dos <code>geom</code>s do ggplot2 é o <code>geom_smooth()</code> que pode ser usado para plotar diversos modelos de regressão que não apenas lineares.
É suplementado pela camada <code>stat_smooth()</code> que tem mais funcionalidade e mais customização.
Para criar um gráfico com os pontos e a linha de regressão precisamos apenas dos dados de concentração e absorbância:</p>
<div class="sourceCode" id="cb155"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb155-1" title="1"><span class="kw">ggplot</span>(calibracao,</a>
<a class="sourceLine" id="cb155-2" title="2">             <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb155-3" title="3">                <span class="dt">x =</span> conc,</a>
<a class="sourceLine" id="cb155-4" title="4">                <span class="dt">y =</span> abs</a>
<a class="sourceLine" id="cb155-5" title="5">             )) <span class="op">+</span></a>
<a class="sourceLine" id="cb155-6" title="6"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb155-7" title="7"><span class="st">    </span><span class="co"># method = lm indica que quero representar um modelo linear,</span></a>
<a class="sourceLine" id="cb155-8" title="8"><span class="st">    </span><span class="co"># se = FALSE indica que não quero mostrar o erro padrão calculado</span></a>
<a class="sourceLine" id="cb155-9" title="9"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-31-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Porém o <code>ggplot2</code> não inclui nada que nos permita adicionar a equação com os coeficientes e o <span class="math inline">\(R^2\)</span> automaticamente portanto temos que adicionar individualmente usando os dados extraídos com a nossa função <code>extrair()</code>.</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb156-1" title="1">coefs &lt;-<span class="st"> </span><span class="kw">extrair</span>(<span class="dt">fit =</span> fit_calib)</a>
<a class="sourceLine" id="cb156-2" title="2">coefs</a></code></pre></div>
<pre><code>  Coeficiente.Linear Coeficiente.Angular R.quadrado
1           1.000206            2.020335  0.9989394</code></pre>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb158-1" title="1"><span class="kw">ggplot</span>(calibracao,</a>
<a class="sourceLine" id="cb158-2" title="2">             <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb158-3" title="3">                <span class="dt">x =</span> conc,</a>
<a class="sourceLine" id="cb158-4" title="4">                <span class="dt">y =</span> abs</a>
<a class="sourceLine" id="cb158-5" title="5">             )) <span class="op">+</span></a>
<a class="sourceLine" id="cb158-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb158-7" title="7"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb158-8" title="8"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</a>
<a class="sourceLine" id="cb158-9" title="9">                     <span class="dt">x =</span> <span class="dv">5</span>, <span class="co"># posição no eixo x </span></a>
<a class="sourceLine" id="cb158-10" title="10">                     <span class="dt">y =</span> <span class="dv">40</span>, <span class="co"># posição no eixo y</span></a>
<a class="sourceLine" id="cb158-11" title="11">                     <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;y = &quot;</span>, coefs<span class="op">$</span>Coeficiente.Angular, <span class="st">&quot;x + &quot;</span>, coefs<span class="op">$</span>Coeficiente.Linear)) <span class="op">+</span></a>
<a class="sourceLine" id="cb158-12" title="12"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</a>
<a class="sourceLine" id="cb158-13" title="13">                     <span class="dt">x =</span> <span class="dv">5</span>, <span class="co"># posição no eixo x </span></a>
<a class="sourceLine" id="cb158-14" title="14">                     <span class="dt">y =</span> <span class="dv">36</span>, <span class="co"># posição no eixo y</span></a>
<a class="sourceLine" id="cb158-15" title="15">                     <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;R quadrado = &quot;</span>, coefs<span class="op">$</span>R.quadrado))</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-32-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Claro que agora temos um problema de números significativos em excesso e de formatação da equação e do <span class="math inline">\(R^2\)</span>.
Para resolver isso temos que usar a função <code>format()</code>para reduzir o número de dígitos significativos ou <code>round()</code> para arredondar e o argumento <code>parse == TRUE</code> para forçar o sobrescrito na camada de anotação.</p>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb159-1" title="1"><span class="kw">ggplot</span>(calibracao,</a>
<a class="sourceLine" id="cb159-2" title="2">             <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb159-3" title="3">                <span class="dt">x =</span> conc,</a>
<a class="sourceLine" id="cb159-4" title="4">                <span class="dt">y =</span> abs</a>
<a class="sourceLine" id="cb159-5" title="5">             )) <span class="op">+</span></a>
<a class="sourceLine" id="cb159-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb159-7" title="7"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb159-8" title="8"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</a>
<a class="sourceLine" id="cb159-9" title="9">                     <span class="dt">x =</span> <span class="dv">5</span>, <span class="co"># posição no eixo x </span></a>
<a class="sourceLine" id="cb159-10" title="10">                     <span class="dt">y =</span> <span class="dv">40</span>, <span class="co"># posição no eixo y</span></a>
<a class="sourceLine" id="cb159-11" title="11">                     <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;y = &quot;</span>, <span class="kw">round</span>(coefs<span class="op">$</span>Coeficiente.Angular, <span class="dt">digits =</span> <span class="dv">3</span>), <span class="st">&quot;x + &quot;</span>, <span class="kw">format</span>(coefs<span class="op">$</span>Coeficiente.Linear, <span class="dt">digits =</span> <span class="dv">2</span>))) <span class="op">+</span></a>
<a class="sourceLine" id="cb159-12" title="12"><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</a>
<a class="sourceLine" id="cb159-13" title="13">                     <span class="dt">x =</span> <span class="dv">5</span>, <span class="co"># posição no eixo x </span></a>
<a class="sourceLine" id="cb159-14" title="14">                     <span class="dt">y =</span> <span class="dv">36</span>, <span class="co"># posição no eixo y</span></a>
<a class="sourceLine" id="cb159-15" title="15">                     <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;R^2 ==&quot;</span>, <span class="kw">round</span>(coefs<span class="op">$</span>R.quadrado, <span class="dt">digits =</span> <span class="dv">4</span>)) ,</a>
<a class="sourceLine" id="cb159-16" title="16">                     <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="co"># força a renderização do texto como uma expressão matemática</span></a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-33-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Claro que podemos escrever uma função usando as funções do <code>ggplot</code> para simplificar a construção destes gráficos, e esta pode ser uma alternativa viável mas outras pessoas já fizeram isso e publicaram pacotes justamente para atender esta necessidade.</p>
</div>
<div id="método-ggpmisc" class="section level3">
<h3><span class="header-section-number">5.1.3</span> Método <code>ggpmisc</code></h3>
<p>O pacote <code>ggpmisc</code> é uma extensão do <code>ggplot</code> que adiciona funcionalidades sobre o mesmo.
Com ele adicionar a equação e os coeficientes se torna muito mais simples.</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb160-1" title="1"><span class="kw">library</span>(ggpmisc)</a>
<a class="sourceLine" id="cb160-2" title="2"></a>
<a class="sourceLine" id="cb160-3" title="3"><span class="kw">ggplot</span>(calibracao,</a>
<a class="sourceLine" id="cb160-4" title="4">             <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb160-5" title="5">                <span class="dt">x =</span> conc,</a>
<a class="sourceLine" id="cb160-6" title="6">                <span class="dt">y =</span> abs</a>
<a class="sourceLine" id="cb160-7" title="7">             )) <span class="op">+</span></a>
<a class="sourceLine" id="cb160-8" title="8"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb160-9" title="9"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb160-10" title="10"><span class="st">    </span><span class="co"># retirado da página do criador do pacote</span></a>
<a class="sourceLine" id="cb160-11" title="11"><span class="st">    </span><span class="co"># https://github.com/cran/ggpmisc</span></a>
<a class="sourceLine" id="cb160-12" title="12"><span class="st">  </span><span class="kw">stat_poly_eq</span>(<span class="kw">aes</span>(<span class="dt">label =</span>  <span class="kw">paste</span>(..eq.label.., ..adj.rr.label.., <span class="dt">sep =</span> <span class="st">&quot;~~~~&quot;</span>)),</a>
<a class="sourceLine" id="cb160-13" title="13">               <span class="dt">formula =</span> <span class="st">&quot;y~x&quot;</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-34-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Admito que não sei usar as funções deste pacote então recomendo que quem estiver lendo estas informaçõs busque outras fontes de conteúdo.
A <a href="https://github.com/cran/ggpmisc">página</a> do desenvolvedor contém várias informações e exemplos.</p>
</div>
<div id="método-ggpubr" class="section level3">
<h3><span class="header-section-number">5.1.4</span> Método <code>ggpubr</code></h3>
<p>Provavelmente este é o método mais simples para gerar gráficos de regressão linear para uma curva de calibração.
O pacote é outra extensão do <code>ggplot2</code> e foi feito para facilitar a construção de <em>plots</em> comuns no meio científico.
A <a href="https://rpkgs.datanovia.com/ggpubr/index.html">página</a> possui vários exemplos e a documentação necessária para criação dos gráficos.</p>
<p>O <code>ggpubr</code> é uma ferramenta que facilita bastante o uso do <code>R</code> para construção de gráficos, porém com algumas desvantagens e limitaçòes de customização.
A sintaxe é um pouco diferente do <code>ggplot</code> mas similar o suficiente para não criar uma barreira para o usuário.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb161-1" title="1"><span class="kw">library</span>(ggpubr)</a>
<a class="sourceLine" id="cb161-2" title="2"></a>
<a class="sourceLine" id="cb161-3" title="3">ggpubr &lt;-<span class="st"> </span><span class="kw">ggscatter</span>(calibracao,</a>
<a class="sourceLine" id="cb161-4" title="4">                    <span class="dt">x =</span> <span class="st">&quot;conc&quot;</span>,</a>
<a class="sourceLine" id="cb161-5" title="5">                    <span class="dt">y =</span> <span class="st">&quot;abs&quot;</span>,</a>
<a class="sourceLine" id="cb161-6" title="6">                    <span class="dt">add =</span> <span class="st">&quot;reg.line&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb161-7" title="7"><span class="st">    </span><span class="kw">stat_cor</span>(<span class="dt">label.x =</span> <span class="dv">5</span>, <span class="dt">label.y =</span> <span class="dv">36</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb161-8" title="8"><span class="st">    </span><span class="kw">stat_regline_equation</span>(<span class="dt">label.x =</span> <span class="dv">5</span>, <span class="dt">label.y =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb161-9" title="9"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Criado com ggpubr&quot;</span>)</a>
<a class="sourceLine" id="cb161-10" title="10"></a>
<a class="sourceLine" id="cb161-11" title="11">ggpubr</a></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-35-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Alternativamente as funções do <code>ggpubr</code> podem ser usadas em <em>plots</em> criados com o <code>ggplot2</code> porque os objetos criados pelos dois tem compatibilidades.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb162-1" title="1">gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(calibracao,</a>
<a class="sourceLine" id="cb162-2" title="2">             <span class="kw">aes</span>(</a>
<a class="sourceLine" id="cb162-3" title="3">                <span class="dt">x =</span> conc,</a>
<a class="sourceLine" id="cb162-4" title="4">                <span class="dt">y =</span> abs</a>
<a class="sourceLine" id="cb162-5" title="5">             )) <span class="op">+</span></a>
<a class="sourceLine" id="cb162-6" title="6"><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb162-7" title="7"><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></a>
<a class="sourceLine" id="cb162-8" title="8"><span class="st">    </span><span class="kw">stat_cor</span>(<span class="dt">label.x =</span> <span class="dv">5</span>, <span class="dt">label.y =</span> <span class="dv">36</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb162-9" title="9"><span class="st">    </span><span class="kw">stat_regline_equation</span>(<span class="dt">label.x =</span> <span class="dv">5</span>, <span class="dt">label.y =</span> <span class="dv">40</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb162-10" title="10"><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Criado com ggplot2 + ggpubr&quot;</span>)</a>
<a class="sourceLine" id="cb162-11" title="11"></a>
<a class="sourceLine" id="cb162-12" title="12"></a>
<a class="sourceLine" id="cb162-13" title="13"><span class="co"># usando patchwork</span></a>
<a class="sourceLine" id="cb162-14" title="14">ggpubr <span class="op">+</span><span class="st"> </span>gg</a></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-36-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Existe uma infinidade de formas de mostrar estes dados, o importante é achar a forma que melhor atende suas necessidades e que seja o mais fácil criar.</p>
<hr />

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="regressões.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="references.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
