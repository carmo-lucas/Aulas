<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6.1 Regressões | Aulas de R</title>
  <meta name="description" content="6.1 Regressões | Aulas de R" />
  <meta name="generator" content="bookdown 0.18 and GitBook 2.6.7" />

  <meta property="og:title" content="6.1 Regressões | Aulas de R" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6.1 Regressões | Aulas de R" />
  
  
  

<meta name="author" content="Lucas Chagas Lima do Carmo" />


<meta name="date" content="2020-07-16" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="tutoriais.html"/>
<link rel="next" href="smoothing.html"/>
<script src="assets/header-attrs-2.1/header-attrs.js"></script>
<script src="assets/jquery-2.2.3/jquery.min.js"></script>
<link href="assets/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="assets/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introdução</a></li>
<li class="chapter" data-level="1" data-path="tipos-de-dados.html"><a href="tipos-de-dados.html"><i class="fa fa-check"></i><b>1</b> Tipos de Dados</a></li>
<li class="chapter" data-level="2" data-path="tipos-de-objetos.html"><a href="tipos-de-objetos.html"><i class="fa fa-check"></i><b>2</b> Tipos de objetos</a>
<ul>
<li class="chapter" data-level="2.1" data-path="vetores.html"><a href="vetores.html"><i class="fa fa-check"></i><b>2.1</b> Vetores</a></li>
<li class="chapter" data-level="2.2" data-path="matrizes.html"><a href="matrizes.html"><i class="fa fa-check"></i><b>2.2</b> Matrizes</a></li>
<li class="chapter" data-level="2.3" data-path="índices.html"><a href="índices.html"><i class="fa fa-check"></i><b>2.3</b> Índices</a></li>
<li class="chapter" data-level="2.4" data-path="dataframes.html"><a href="dataframes.html"><i class="fa fa-check"></i><b>2.4</b> Dataframes</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="dataframes.html"><a href="dataframes.html#índices-de-dataframes"><i class="fa fa-check"></i><b>2.4.1</b> Índices de dataframes</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="listas.html"><a href="listas.html"><i class="fa fa-check"></i><b>2.5</b> Listas</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="listas.html"><a href="listas.html#índices-de-listas"><i class="fa fa-check"></i><b>2.5.1</b> Índices de listas</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="operadores.html"><a href="operadores.html"><i class="fa fa-check"></i><b>3</b> Operadores</a>
<ul>
<li class="chapter" data-level="3.1" data-path="operadores-aritméticos.html"><a href="operadores-aritméticos.html"><i class="fa fa-check"></i><b>3.1</b> Operadores aritméticos</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="operadores-aritméticos.html"><a href="operadores-aritméticos.html#exemplos"><i class="fa fa-check"></i><b>3.1.1</b> Exemplos</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="operadores-lógicos.html"><a href="operadores-lógicos.html"><i class="fa fa-check"></i><b>3.2</b> Operadores Lógicos</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="operadores-lógicos.html"><a href="operadores-lógicos.html#exemplos-1"><i class="fa fa-check"></i><b>3.2.1</b> Exemplos</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="extensões.html"><a href="extensões.html"><i class="fa fa-check"></i><b>4</b> Extensões</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tidyverse.html"><a href="tidyverse.html"><i class="fa fa-check"></i><b>4.1</b> <code>tidyverse</code></a>
<ul>
<li class="chapter" data-level="4.1.1" data-path="tidyverse.html"><a href="tidyverse.html#dplyr"><i class="fa fa-check"></i><b>4.1.1</b> <code>dplyr</code></a></li>
<li class="chapter" data-level="4.1.2" data-path="tidyverse.html"><a href="tidyverse.html#tidyr"><i class="fa fa-check"></i><b>4.1.2</b> <code>tidyr</code></a></li>
<li class="chapter" data-level="4.1.3" data-path="tidyverse.html"><a href="tidyverse.html#readr"><i class="fa fa-check"></i><b>4.1.3</b> <code>readr</code></a></li>
<li class="chapter" data-level="4.1.4" data-path="tidyverse.html"><a href="tidyverse.html#stringr"><i class="fa fa-check"></i><b>4.1.4</b> <code>stringr</code></a></li>
<li class="chapter" data-level="4.1.5" data-path="tidyverse.html"><a href="tidyverse.html#tibble"><i class="fa fa-check"></i><b>4.1.5</b> <code>tibble</code></a></li>
<li class="chapter" data-level="4.1.6" data-path="tidyverse.html"><a href="tidyverse.html#purrr"><i class="fa fa-check"></i><b>4.1.6</b> <code>purrr</code></a></li>
<li class="chapter" data-level="4.1.7" data-path="tidyverse.html"><a href="tidyverse.html#forcats"><i class="fa fa-check"></i><b>4.1.7</b> <code>forcats</code></a></li>
<li class="chapter" data-level="4.1.8" data-path="tidyverse.html"><a href="tidyverse.html#magrittr"><i class="fa fa-check"></i><b>4.1.8</b> <code>magrittr</code></a></li>
<li class="chapter" data-level="4.1.9" data-path="tidyverse.html"><a href="tidyverse.html#ggplot2"><i class="fa fa-check"></i><b>4.1.9</b> <code>ggplot2</code></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ggplot2-1.html"><a href="ggplot2-1.html"><i class="fa fa-check"></i><b>5</b> <code>ggplot2</code></a>
<ul>
<li class="chapter" data-level="5.1" data-path="gramática-de-gráficos.html"><a href="gramática-de-gráficos.html"><i class="fa fa-check"></i><b>5.1</b> Gramática de Gráficos</a></li>
<li class="chapter" data-level="5.2" data-path="instalação.html"><a href="instalação.html"><i class="fa fa-check"></i><b>5.2</b> Instalação</a></li>
<li class="chapter" data-level="5.3" data-path="componentes-principais-dos-gráficos.html"><a href="componentes-principais-dos-gráficos.html"><i class="fa fa-check"></i><b>5.3</b> Componentes principais dos gráficos</a></li>
<li class="chapter" data-level="5.4" data-path="cores-tamanhos-formas-e-outros-atributos-estéticos.html"><a href="cores-tamanhos-formas-e-outros-atributos-estéticos.html"><i class="fa fa-check"></i><b>5.4</b> Cores, tamanhos, formas e outros atributos estéticos</a></li>
<li class="chapter" data-level="5.5" data-path="geoms.html"><a href="geoms.html"><i class="fa fa-check"></i><b>5.5</b> Geoms</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="geoms.html"><a href="geoms.html#geoms-individuais"><i class="fa fa-check"></i><b>5.5.1</b> Geoms individuais</a></li>
<li class="chapter" data-level="5.5.2" data-path="geoms.html"><a href="geoms.html#geoms-coletivos"><i class="fa fa-check"></i><b>5.5.2</b> Geoms coletivos</a></li>
<li class="chapter" data-level="5.5.3" data-path="geoms.html"><a href="geoms.html#resumos-estatísticos"><i class="fa fa-check"></i><b>5.5.3</b> Resumos estatísticos</a></li>
<li class="chapter" data-level="5.5.4" data-path="geoms.html"><a href="geoms.html#plotando-distribuições"><i class="fa fa-check"></i><b>5.5.4</b> Plotando distribuições</a></li>
<li class="chapter" data-level="5.5.5" data-path="geoms.html"><a href="geoms.html#anotações"><i class="fa fa-check"></i><b>5.5.5</b> Anotações</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="legendas.html"><a href="legendas.html"><i class="fa fa-check"></i><b>5.6</b> Legendas</a></li>
<li class="chapter" data-level="5.7" data-path="escalas.html"><a href="escalas.html"><i class="fa fa-check"></i><b>5.7</b> Escalas</a></li>
<li class="chapter" data-level="5.8" data-path="facets.html"><a href="facets.html"><i class="fa fa-check"></i><b>5.8</b> Facets</a></li>
<li class="chapter" data-level="5.9" data-path="temas.html"><a href="temas.html"><i class="fa fa-check"></i><b>5.9</b> Temas</a></li>
<li class="chapter" data-level="5.10" data-path="organizando-os-plots.html"><a href="organizando-os-plots.html"><i class="fa fa-check"></i><b>5.10</b> Organizando os <em>plots</em></a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tutoriais.html"><a href="tutoriais.html"><i class="fa fa-check"></i><b>6</b> Tutoriais</a>
<ul>
<li class="chapter" data-level="6.1" data-path="regressões.html"><a href="regressões.html"><i class="fa fa-check"></i><b>6.1</b> Regressões</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="regressões.html"><a href="regressões.html#regressões-lineares"><i class="fa fa-check"></i><b>6.1.1</b> Regressões Lineares</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="smoothing.html"><a href="smoothing.html"><i class="fa fa-check"></i><b>6.2</b> Smoothing</a></li>
<li class="chapter" data-level="6.3" data-path="gráficos-deslocados-no-eixo-y.html"><a href="gráficos-deslocados-no-eixo-y.html"><i class="fa fa-check"></i><b>6.3</b> Gráficos deslocados no eixo <code>y</code></a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="gráficos-deslocados-no-eixo-y.html"><a href="gráficos-deslocados-no-eixo-y.html#exemplos-de-gráficos"><i class="fa fa-check"></i><b>6.3.1</b> Exemplos de gráficos</a></li>
<li class="chapter" data-level="6.3.2" data-path="gráficos-deslocados-no-eixo-y.html"><a href="gráficos-deslocados-no-eixo-y.html#transformação-de-dados"><i class="fa fa-check"></i><b>6.3.2</b> Transformação de dados</a></li>
<li class="chapter" data-level="6.3.3" data-path="gráficos-deslocados-no-eixo-y.html"><a href="gráficos-deslocados-no-eixo-y.html#wide-vs.-long"><i class="fa fa-check"></i><b>6.3.3</b> <code>wide</code> vs. <code>long</code></a></li>
<li class="chapter" data-level="6.3.4" data-path="gráficos-deslocados-no-eixo-y.html"><a href="gráficos-deslocados-no-eixo-y.html#construindo-o-gráfico"><i class="fa fa-check"></i><b>6.3.4</b> Construindo o gráfico</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Aulas de R</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="regressões" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Regressões</h2>
<p>Para criar modelos de regressão linear ou não linear no <code>R</code> precisamos usar uma tipo de objeto que tem a é da classe <code>formula</code>.
Esta classe é usada em várias funções de base do <code>R</code> mas também no pacote de criação de gráficos <code>ggplot2::</code>.
O que é essa classe <code>formula</code>: é um tipo de objeto que captura uma relacionamento simbólico entre variáveis, por exemplo:</p>
<ul>
<li>Tendo <code>x</code> como uma variável independente e <code>y</code> a variável dependente, para escrever <span class="math inline">\(y\)</span> em função de <span class="math inline">\(x\)</span> usamos a sytaxe <code>y ~ x</code>,
onde o operador <code>~</code> separa as variáveis.</li>
</ul>
<p>Para modelos lineares esse é o mínimo que é necessário saber porém para mais informação sobre regressões com mais variáveis e modelos não lineares dê uma olhada neste <a href="https://www.datacamp.com/community/tutorials/r-formula-tutorial#datastructures">link</a>.</p>
<div id="regressões-lineares" class="section level3" number="6.1.1">
<h3><span class="header-section-number">6.1.1</span> Regressões Lineares</h3>
<p>No <code>R</code> para criar modelos lineares simples é usada a função <code>lm()</code>.
Os principais argumentos são a <code>formula</code> e os dasos (<code>data</code>), você pode ler os outros argumentos usando rodando <code>?lm()</code> no console.
Então para montar um modelo de regressão limples é apenas necessário ter um dataframe com uma coluna com os valores de <code>x</code> e uma coluna com os valores de <code>y</code>.
Iremos usar os dados do dataset <code>mpg</code> para criar exemplos.</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="regressões.html#cb182-1"></a>fit &lt;-<span class="st"> </span><span class="kw">lm</span>(cty <span class="op">~</span><span class="st"> </span>displ, <span class="dt">data =</span> mpg)</span>
<span id="cb182-2"><a href="regressões.html#cb182-2"></a></span>
<span id="cb182-3"><a href="regressões.html#cb182-3"></a><span class="kw">print</span>(fit)</span></code></pre></div>
<pre><code>
Call:
lm(formula = cty ~ displ, data = mpg)

Coefficients:
(Intercept)        displ  
      25.99        -2.63  </code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="regressões.html#cb184-1"></a><span class="kw">class</span>(fit)</span></code></pre></div>
<pre><code>[1] &quot;lm&quot;</code></pre>
<p>O resultado obtidos são o coeficientes de <em>Intercept</em> que é o coeficiente linear da reta e o outro coeficiente que tem o nome da variável é o coeficiente angular da reta.
A função <code>print()</code> mostra apenas estes valores mas podemos acessar mais valores do modelo usando outras funções ou métodos.</p>
<p>Observamos também que a classe do objeto <code>fit</code> que foi criado é <code>lm</code>, portanto qualquer função que tenha como acessar os dados contidos em objetos de classe <code>lm</code> podem ser usadas, por exemplo <code>summary()</code></p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="regressões.html#cb186-1"></a><span class="kw">summary</span>(fit)</span></code></pre></div>
<pre><code>
Call:
lm(formula = cty ~ displ, data = mpg)

Residuals:
    Min      1Q  Median      3Q     Max 
-6.3109 -1.4695 -0.2566  1.1087 14.0064 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  25.9915     0.4821   53.91   &lt;2e-16 ***
displ        -2.6305     0.1302  -20.20   &lt;2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 2.567 on 232 degrees of freedom
Multiple R-squared:  0.6376,    Adjusted R-squared:  0.6361 
F-statistic: 408.2 on 1 and 232 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Usando a função <code>summary()</code> obtemos vários valores que podem não ter muito significado quando o interesse é verificar o coeficiente de determinação (<span class="math inline">\(R^2\)</span>) de um modelo, inclusive a função <code>summary()</code> retorna este valor mas também dados sobre a distribuição de residuais, erro dos coeficientes e outros valores estatísticos.
Inclusive podemos visualizar estes dados usando a função <code>plot()</code> de base que consegue gerar vários gráficos apenas com o objeto de classe <code>lm</code>.</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="regressões.html#cb188-1"></a><span class="kw">plot</span>(fit)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-43-1.png" width="2100" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-43-2.png" width="2100" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-43-3.png" width="2100" style="display: block; margin: auto;" /><img src="_main_files/figure-html/unnamed-chunk-43-4.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Porém para o uso em questão isso não é extremamente relevante porque não estamos buscando avaliar a normalidade da distribuição e sim verificar se o modelo é adequado para uma curva de calibração.</p>
<p>Neste caso iremos gerar dados simulados para calcular um novo modelo:</p>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="regressões.html#cb189-1"></a><span class="co"># concentração de 0 a 20</span></span>
<span id="cb189-2"><a href="regressões.html#cb189-2"></a>conc &lt;-<span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">20</span> </span>
<span id="cb189-3"><a href="regressões.html#cb189-3"></a></span>
<span id="cb189-4"><a href="regressões.html#cb189-4"></a><span class="co"># absorbância é igual a 2x a concentração mais um valor entre 0,5 e 1</span></span>
<span id="cb189-5"><a href="regressões.html#cb189-5"></a>abs  =<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>conc <span class="op">+</span><span class="st"> </span><span class="kw">runif</span>(<span class="dt">n =</span> <span class="kw">length</span>(conc), <span class="dt">min =</span> <span class="fl">0.5</span>, <span class="dt">max =</span> <span class="dv">2</span>)</span>
<span id="cb189-6"><a href="regressões.html#cb189-6"></a></span>
<span id="cb189-7"><a href="regressões.html#cb189-7"></a>calibracao &lt;-<span class="st"> </span><span class="kw">data.frame</span>(conc, abs)</span>
<span id="cb189-8"><a href="regressões.html#cb189-8"></a></span>
<span id="cb189-9"><a href="regressões.html#cb189-9"></a>calibracao</span></code></pre></div>
<pre><code>   conc       abs
1     0  1.982326
2     1  2.721829
3     2  5.422521
4     3  7.360646
5     4  9.771787
6     5 11.860510
7     6 13.097058
8     7 15.577916
9     8 16.548146
10    9 19.506103
11   10 21.327512
12   11 23.142070
13   12 25.857850
14   13 26.516199
15   14 29.907887
16   15 31.446657
17   16 32.895977
18   17 35.633824
19   18 37.150200
20   19 38.770773
21   20 40.998026</code></pre>
<p>Com os dados gerados podemos gerar o modelo linear para os dados de <code>calibracao</code>.</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="regressões.html#cb191-1"></a>fit_calib &lt;-<span class="st"> </span><span class="kw">lm</span>(abs <span class="op">~</span><span class="st"> </span>conc, <span class="dt">data =</span> calibracao)</span>
<span id="cb191-2"><a href="regressões.html#cb191-2"></a></span>
<span id="cb191-3"><a href="regressões.html#cb191-3"></a><span class="kw">summary</span>(fit_calib)</span></code></pre></div>
<pre><code>
Call:
lm(formula = abs ~ conc, data = calibracao)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.79931 -0.28852 -0.00661  0.34808  0.67482 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.49997    0.18867    7.95 1.84e-07 ***
conc         1.98094    0.01614  122.75  &lt; 2e-16 ***
---
Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1

Residual standard error: 0.4478 on 19 degrees of freedom
Multiple R-squared:  0.9987,    Adjusted R-squared:  0.9987 
F-statistic: 1.507e+04 on 1 and 19 DF,  p-value: &lt; 2.2e-16</code></pre>
<p>Como esperado, o coeficiente angular é de aproximadamente 2 e o coeficiente linear que deveria ser 0 é de 1.4999662.
Como todos os objetos, o objeto da classe <code>lm</code> possui uma estrutura.
Podemos ver esta estrutura usando a função <code>str()</code>, que retorna a estrutura completa dos objetos, porém de uma forma não muito fácil de entender</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="regressões.html#cb193-1"></a><span class="kw">str</span>(fit_calib)</span></code></pre></div>
<pre><code>List of 12
 $ coefficients : Named num [1:2] 1.5 1.98
  ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;(Intercept)&quot; &quot;conc&quot;
 $ residuals    : Named num [1:21] 0.4824 -0.7591 -0.0393 -0.0821 0.3481 ...
  ..- attr(*, &quot;names&quot;)= chr [1:21] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
 $ effects      : Named num [1:21] -97.6516 54.9687 0.0244 -0.0426 0.3635 ...
  ..- attr(*, &quot;names&quot;)= chr [1:21] &quot;(Intercept)&quot; &quot;conc&quot; &quot;&quot; &quot;&quot; ...
 $ rank         : int 2
 $ fitted.values: Named num [1:21] 1.5 3.48 5.46 7.44 9.42 ...
  ..- attr(*, &quot;names&quot;)= chr [1:21] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
 $ assign       : int [1:2] 0 1
 $ qr           :List of 5
  ..$ qr   : num [1:21, 1:2] -4.583 0.218 0.218 0.218 0.218 ...
  .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. ..$ : chr [1:21] &quot;1&quot; &quot;2&quot; &quot;3&quot; &quot;4&quot; ...
  .. .. ..$ : chr [1:2] &quot;(Intercept)&quot; &quot;conc&quot;
  .. ..- attr(*, &quot;assign&quot;)= int [1:2] 0 1
  ..$ qraux: num [1:2] 1.22 1.26
  ..$ pivot: int [1:2] 1 2
  ..$ tol  : num 1e-07
  ..$ rank : int 2
  ..- attr(*, &quot;class&quot;)= chr &quot;qr&quot;
 $ df.residual  : int 19
 $ xlevels      : Named list()
 $ call         : language lm(formula = abs ~ conc, data = calibracao)
 $ terms        :Classes &#39;terms&#39;, &#39;formula&#39;  language abs ~ conc
  .. ..- attr(*, &quot;variables&quot;)= language list(abs, conc)
  .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
  .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. .. ..$ : chr [1:2] &quot;abs&quot; &quot;conc&quot;
  .. .. .. ..$ : chr &quot;conc&quot;
  .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;conc&quot;
  .. ..- attr(*, &quot;order&quot;)= int 1
  .. ..- attr(*, &quot;intercept&quot;)= int 1
  .. ..- attr(*, &quot;response&quot;)= int 1
  .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
  .. ..- attr(*, &quot;predvars&quot;)= language list(abs, conc)
  .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
  .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;abs&quot; &quot;conc&quot;
 $ model        :&#39;data.frame&#39;:  21 obs. of  2 variables:
  ..$ abs : num [1:21] 1.98 2.72 5.42 7.36 9.77 ...
  ..$ conc: int [1:21] 0 1 2 3 4 5 6 7 8 9 ...
  ..- attr(*, &quot;terms&quot;)=Classes &#39;terms&#39;, &#39;formula&#39;  language abs ~ conc
  .. .. ..- attr(*, &quot;variables&quot;)= language list(abs, conc)
  .. .. ..- attr(*, &quot;factors&quot;)= int [1:2, 1] 0 1
  .. .. .. ..- attr(*, &quot;dimnames&quot;)=List of 2
  .. .. .. .. ..$ : chr [1:2] &quot;abs&quot; &quot;conc&quot;
  .. .. .. .. ..$ : chr &quot;conc&quot;
  .. .. ..- attr(*, &quot;term.labels&quot;)= chr &quot;conc&quot;
  .. .. ..- attr(*, &quot;order&quot;)= int 1
  .. .. ..- attr(*, &quot;intercept&quot;)= int 1
  .. .. ..- attr(*, &quot;response&quot;)= int 1
  .. .. ..- attr(*, &quot;.Environment&quot;)=&lt;environment: R_GlobalEnv&gt; 
  .. .. ..- attr(*, &quot;predvars&quot;)= language list(abs, conc)
  .. .. ..- attr(*, &quot;dataClasses&quot;)= Named chr [1:2] &quot;numeric&quot; &quot;numeric&quot;
  .. .. .. ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;abs&quot; &quot;conc&quot;
 - attr(*, &quot;class&quot;)= chr &quot;lm&quot;</code></pre>
<p>Mas o que podemos observar é que o objeto é uma lista com 12 elementos então podemos acessar estes elementos através de seus índices ou de seus nomes.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="regressões.html#cb195-1"></a><span class="co"># coeficientes</span></span>
<span id="cb195-2"><a href="regressões.html#cb195-2"></a>fit_calib<span class="op">$</span>coefficients</span></code></pre></div>
<pre><code>(Intercept)        conc 
   1.499966    1.980936 </code></pre>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="regressões.html#cb197-1"></a><span class="co"># residuais</span></span>
<span id="cb197-2"><a href="regressões.html#cb197-2"></a>fit_calib<span class="op">$</span>residuals</span></code></pre></div>
<pre><code>           1            2            3            4            5            6            7 
 0.482359703 -0.759073467 -0.039316641 -0.082127802  0.348077515  0.455864382 -0.288522907 
           8            9           10           11           12           13           14 
 0.211399100 -0.799307318  0.177713826  0.018187679 -0.148190512  0.586653401 -0.735933044 
          15           16           17           18           19           20           21 
 0.674818817  0.232653243 -0.298962856  0.457948878 -0.006610919 -0.366974424 -0.120656654 </code></pre>
<p>E para acessar elementos específicos destas listas usamos os operadores <code>[ ]</code></p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="regressões.html#cb199-1"></a><span class="co"># coeficiente linear (intercept)</span></span>
<span id="cb199-2"><a href="regressões.html#cb199-2"></a>fit_calib<span class="op">$</span>coefficients[<span class="dv">1</span>]</span></code></pre></div>
<pre><code>(Intercept) 
   1.499966 </code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="regressões.html#cb201-1"></a><span class="co"># coeficiente angular</span></span>
<span id="cb201-2"><a href="regressões.html#cb201-2"></a>fit_calib<span class="op">$</span>coefficients[<span class="dv">2</span>]</span></code></pre></div>
<pre><code>    conc 
1.980936 </code></pre>
<div class="sourceCode" id="cb203"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="regressões.html#cb203-1"></a><span class="co"># valor do coeficiente linear (intercept)</span></span>
<span id="cb203-2"><a href="regressões.html#cb203-2"></a>fit_calib<span class="op">$</span>coefficients[[<span class="dv">1</span>]]</span></code></pre></div>
<pre><code>[1] 1.499966</code></pre>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="regressões.html#cb205-1"></a><span class="co"># valor do coeficiente angular</span></span>
<span id="cb205-2"><a href="regressões.html#cb205-2"></a>fit_calib<span class="op">$</span>coefficients[[<span class="dv">2</span>]]</span></code></pre></div>
<pre><code>[1] 1.980936</code></pre>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="regressões.html#cb207-1"></a><span class="co"># R quadrado</span></span>
<span id="cb207-2"><a href="regressões.html#cb207-2"></a><span class="kw">summary</span>(fit_calib)<span class="op">$</span>r.squared</span></code></pre></div>
<pre><code>[1] 0.9987405</code></pre>
<p>Claro que parece muito complicado ter que fazer tudo isso para extrair alguns dados e mesmo assim, existem várias formas de extraí-los o que causa muita confusão, portanto iremos explorar alguns métodos para extraír estes dados do objeto <code>lm()</code>.</p>
<div id="método-de-função" class="section level4" number="6.1.1.1">
<h4><span class="header-section-number">6.1.1.1</span> Método de função</h4>
<p>É fundamental em qualquer linguagem de programação que se saiba escrever funções que facilitem seu trabalho e deixem o código mais simples.
Neste documento não estão escritas necessariamente as melhores funções que são mais eficientes mas aquelas que funcionam para o que é desejado. Na grande maioria das vezes é melhor escrever uma função rápido do que escrever uma função que funcione rápido.
Otimização de código não é a nossa prioridade agora.</p>
<p>Em outro capítulo será explorado a criação de funções melhor mas agora iremos apenas usar lógica para criar uma função que extraia os dados de coeficiente linear, angular, e <span class="math inline">\(R^2\)</span> e coloque-os em um dataframe com os nomes e os valores usando a sintaxe já demonstrada.</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="regressões.html#cb209-1"></a>extrair &lt;-<span class="st"> </span><span class="cf">function</span>(fit) { <span class="co">#fit é o argumento desta função</span></span>
<span id="cb209-2"><a href="regressões.html#cb209-2"></a>    </span>
<span id="cb209-3"><a href="regressões.html#cb209-3"></a>    <span class="co"># cria variável que contém coeficiente linear</span></span>
<span id="cb209-4"><a href="regressões.html#cb209-4"></a>    coef_lin &lt;-<span class="st"> </span>fit<span class="op">$</span>coefficients[[<span class="dv">1</span>]]</span>
<span id="cb209-5"><a href="regressões.html#cb209-5"></a>    <span class="co"># cria variável que contém coeficiente angular</span></span>
<span id="cb209-6"><a href="regressões.html#cb209-6"></a>    coef_ang &lt;-<span class="st"> </span>fit<span class="op">$</span>coefficients[[<span class="dv">2</span>]]</span>
<span id="cb209-7"><a href="regressões.html#cb209-7"></a>    <span class="co"># cria variável que contém r quadrado</span></span>
<span id="cb209-8"><a href="regressões.html#cb209-8"></a>    r_quadrado &lt;-<span class="st"> </span><span class="kw">summary</span>(fit)<span class="op">$</span>r.squared</span>
<span id="cb209-9"><a href="regressões.html#cb209-9"></a>    </span>
<span id="cb209-10"><a href="regressões.html#cb209-10"></a>    <span class="co"># cria dataframe com os dados em cada coluna</span></span>
<span id="cb209-11"><a href="regressões.html#cb209-11"></a>    tabela &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb209-12"><a href="regressões.html#cb209-12"></a>        <span class="st">&quot;Coeficiente Linear&quot;</span> =<span class="st"> </span>coef_lin,</span>
<span id="cb209-13"><a href="regressões.html#cb209-13"></a>        <span class="st">&quot;Coeficiente Angular&quot;</span> =<span class="st"> </span>coef_ang,</span>
<span id="cb209-14"><a href="regressões.html#cb209-14"></a>        <span class="st">&quot;R quadrado&quot;</span> =<span class="st"> </span>r_quadrado</span>
<span id="cb209-15"><a href="regressões.html#cb209-15"></a>        )</span>
<span id="cb209-16"><a href="regressões.html#cb209-16"></a>    </span>
<span id="cb209-17"><a href="regressões.html#cb209-17"></a>    <span class="co"># pede para a função retornar o dataframe como output</span></span>
<span id="cb209-18"><a href="regressões.html#cb209-18"></a>    <span class="kw">return</span>(tabela)</span>
<span id="cb209-19"><a href="regressões.html#cb209-19"></a>    </span>
<span id="cb209-20"><a href="regressões.html#cb209-20"></a>}</span>
<span id="cb209-21"><a href="regressões.html#cb209-21"></a></span>
<span id="cb209-22"><a href="regressões.html#cb209-22"></a><span class="co"># usando função nos dados de calibração</span></span>
<span id="cb209-23"><a href="regressões.html#cb209-23"></a><span class="kw">extrair</span>(fit_calib)</span></code></pre></div>
<pre><code>  Coeficiente.Linear Coeficiente.Angular R.quadrado
1           1.499966            1.980936  0.9987405</code></pre>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="regressões.html#cb211-1"></a><span class="co"># usando função nos dados de mpg</span></span>
<span id="cb211-2"><a href="regressões.html#cb211-2"></a><span class="kw">extrair</span>(fit)</span></code></pre></div>
<pre><code>  Coeficiente.Linear Coeficiente.Angular R.quadrado
1           25.99147           -2.630482  0.6376405</code></pre>
<p>Agora esta função pode ser usada sempe que se desejar extrair estes dados de um modelo linear criado com <code>lm()</code>.
Não é a função mais robusta e alguns erros podem surgir quando tentando combinar ela com outras operações, mas para uma introdução funciona muito bem.</p>
</div>
<div id="método-ggplot2" class="section level4" number="6.1.1.2">
<h4><span class="header-section-number">6.1.1.2</span> Método <code>ggplot2</code></h4>
<p>Um dos <code>geom</code>s do ggplot2 é o <code>geom_smooth()</code> que pode ser usado para plotar diversos modelos de regressão que não apenas lineares.
É suplementado pela camada <code>stat_smooth()</code> que tem mais funcionalidade e mais customização.
Para criar um gráfico com os pontos e a linha de regressão precisamos apenas dos dados de concentração e absorbância:</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="regressões.html#cb213-1"></a><span class="kw">ggplot</span>(calibracao,</span>
<span id="cb213-2"><a href="regressões.html#cb213-2"></a>             <span class="kw">aes</span>(</span>
<span id="cb213-3"><a href="regressões.html#cb213-3"></a>                <span class="dt">x =</span> conc,</span>
<span id="cb213-4"><a href="regressões.html#cb213-4"></a>                <span class="dt">y =</span> abs</span>
<span id="cb213-5"><a href="regressões.html#cb213-5"></a>             )) <span class="op">+</span></span>
<span id="cb213-6"><a href="regressões.html#cb213-6"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb213-7"><a href="regressões.html#cb213-7"></a><span class="st">    </span><span class="co"># method = lm indica que quero representar um modelo linear,</span></span>
<span id="cb213-8"><a href="regressões.html#cb213-8"></a><span class="st">    </span><span class="co"># se = FALSE indica que não quero mostrar o erro padrão calculado</span></span>
<span id="cb213-9"><a href="regressões.html#cb213-9"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-49-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Porém o <code>ggplot2</code> não inclui nada que nos permita adicionar a equação com os coeficientes e o <span class="math inline">\(R^2\)</span> automaticamente portanto temos que adicionar individualmente usando os dados extraídos com a nossa função <code>extrair()</code>.</p>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="regressões.html#cb214-1"></a>coefs &lt;-<span class="st"> </span><span class="kw">extrair</span>(<span class="dt">fit =</span> fit_calib)</span>
<span id="cb214-2"><a href="regressões.html#cb214-2"></a>coefs</span></code></pre></div>
<pre><code>  Coeficiente.Linear Coeficiente.Angular R.quadrado
1           1.499966            1.980936  0.9987405</code></pre>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="regressões.html#cb216-1"></a><span class="kw">ggplot</span>(calibracao,</span>
<span id="cb216-2"><a href="regressões.html#cb216-2"></a>             <span class="kw">aes</span>(</span>
<span id="cb216-3"><a href="regressões.html#cb216-3"></a>                <span class="dt">x =</span> conc,</span>
<span id="cb216-4"><a href="regressões.html#cb216-4"></a>                <span class="dt">y =</span> abs</span>
<span id="cb216-5"><a href="regressões.html#cb216-5"></a>             )) <span class="op">+</span></span>
<span id="cb216-6"><a href="regressões.html#cb216-6"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>) <span class="op">+</span></span>
<span id="cb216-7"><a href="regressões.html#cb216-7"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb216-8"><a href="regressões.html#cb216-8"></a><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb216-9"><a href="regressões.html#cb216-9"></a>                     <span class="dt">x =</span> <span class="dv">5</span>, <span class="co"># posição no eixo x </span></span>
<span id="cb216-10"><a href="regressões.html#cb216-10"></a>                     <span class="dt">y =</span> <span class="dv">40</span>, <span class="co"># posição no eixo y</span></span>
<span id="cb216-11"><a href="regressões.html#cb216-11"></a>                     <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;y = &quot;</span>, coefs<span class="op">$</span>Coeficiente.Angular, <span class="st">&quot;x + &quot;</span>, coefs<span class="op">$</span>Coeficiente.Linear)) <span class="op">+</span></span>
<span id="cb216-12"><a href="regressões.html#cb216-12"></a><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb216-13"><a href="regressões.html#cb216-13"></a>                     <span class="dt">x =</span> <span class="dv">5</span>, <span class="co"># posição no eixo x </span></span>
<span id="cb216-14"><a href="regressões.html#cb216-14"></a>                     <span class="dt">y =</span> <span class="dv">36</span>, <span class="co"># posição no eixo y</span></span>
<span id="cb216-15"><a href="regressões.html#cb216-15"></a>                     <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;R quadrado = &quot;</span>, coefs<span class="op">$</span>R.quadrado))</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-50-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Claro que agora temos um problema de números significativos em excesso e de formatação da equação e do <span class="math inline">\(R^2\)</span>.
Para resolver isso temos que usar a função <code>format()</code>para reduzir o número de dígitos significativos ou <code>round()</code> para arredondar e o argumento <code>parse == TRUE</code> para forçar o sobrescrito na camada de anotação.</p>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="regressões.html#cb217-1"></a><span class="kw">ggplot</span>(calibracao,</span>
<span id="cb217-2"><a href="regressões.html#cb217-2"></a>             <span class="kw">aes</span>(</span>
<span id="cb217-3"><a href="regressões.html#cb217-3"></a>                <span class="dt">x =</span> conc,</span>
<span id="cb217-4"><a href="regressões.html#cb217-4"></a>                <span class="dt">y =</span> abs</span>
<span id="cb217-5"><a href="regressões.html#cb217-5"></a>             )) <span class="op">+</span></span>
<span id="cb217-6"><a href="regressões.html#cb217-6"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>) <span class="op">+</span></span>
<span id="cb217-7"><a href="regressões.html#cb217-7"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb217-8"><a href="regressões.html#cb217-8"></a><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb217-9"><a href="regressões.html#cb217-9"></a>                     <span class="dt">x =</span> <span class="dv">5</span>, <span class="co"># posição no eixo x </span></span>
<span id="cb217-10"><a href="regressões.html#cb217-10"></a>                     <span class="dt">y =</span> <span class="dv">40</span>, <span class="co"># posição no eixo y</span></span>
<span id="cb217-11"><a href="regressões.html#cb217-11"></a>                     <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;y = &quot;</span>, <span class="kw">round</span>(coefs<span class="op">$</span>Coeficiente.Angular, <span class="dt">digits =</span> <span class="dv">3</span>), <span class="st">&quot;x + &quot;</span>, <span class="kw">format</span>(coefs<span class="op">$</span>Coeficiente.Linear, <span class="dt">digits =</span> <span class="dv">2</span>))) <span class="op">+</span></span>
<span id="cb217-12"><a href="regressões.html#cb217-12"></a><span class="st">    </span><span class="kw">annotate</span>(<span class="dt">geom =</span> <span class="st">&quot;text&quot;</span>,</span>
<span id="cb217-13"><a href="regressões.html#cb217-13"></a>                     <span class="dt">x =</span> <span class="dv">5</span>, <span class="co"># posição no eixo x </span></span>
<span id="cb217-14"><a href="regressões.html#cb217-14"></a>                     <span class="dt">y =</span> <span class="dv">36</span>, <span class="co"># posição no eixo y</span></span>
<span id="cb217-15"><a href="regressões.html#cb217-15"></a>                     <span class="dt">label =</span> <span class="kw">paste0</span>(<span class="st">&quot;R^2 ==&quot;</span>, <span class="kw">round</span>(coefs<span class="op">$</span>R.quadrado, <span class="dt">digits =</span> <span class="dv">4</span>)) ,</span>
<span id="cb217-16"><a href="regressões.html#cb217-16"></a>                     <span class="dt">parse =</span> <span class="ot">TRUE</span>) <span class="co"># força a renderização do texto como uma expressão matemática</span></span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-51-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Claro que podemos escrever uma função usando as funções do <code>ggplot</code> para simplificar a construção destes gráficos, e esta pode ser uma alternativa viável mas outras pessoas já fizeram isso e publicaram pacotes justamente para atender esta necessidade.</p>
</div>
<div id="método-ggpmisc" class="section level4" number="6.1.1.3">
<h4><span class="header-section-number">6.1.1.3</span> Método <code>ggpmisc</code></h4>
<p>O pacote <code>ggpmisc</code> é uma extensão do <code>ggplot</code> que adiciona funcionalidades sobre o mesmo.
Com ele adicionar a equação e os coeficientes se torna muito mais simples.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="regressões.html#cb218-1"></a><span class="kw">library</span>(ggpmisc)</span>
<span id="cb218-2"><a href="regressões.html#cb218-2"></a></span>
<span id="cb218-3"><a href="regressões.html#cb218-3"></a><span class="kw">ggplot</span>(calibracao,</span>
<span id="cb218-4"><a href="regressões.html#cb218-4"></a>             <span class="kw">aes</span>(</span>
<span id="cb218-5"><a href="regressões.html#cb218-5"></a>                <span class="dt">x =</span> conc,</span>
<span id="cb218-6"><a href="regressões.html#cb218-6"></a>                <span class="dt">y =</span> abs</span>
<span id="cb218-7"><a href="regressões.html#cb218-7"></a>             )) <span class="op">+</span></span>
<span id="cb218-8"><a href="regressões.html#cb218-8"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb218-9"><a href="regressões.html#cb218-9"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb218-10"><a href="regressões.html#cb218-10"></a><span class="st">    </span><span class="co"># retirado da página do criador do pacote</span></span>
<span id="cb218-11"><a href="regressões.html#cb218-11"></a><span class="st">    </span><span class="co"># https://github.com/cran/ggpmisc</span></span>
<span id="cb218-12"><a href="regressões.html#cb218-12"></a><span class="st">  </span><span class="kw">stat_poly_eq</span>(<span class="kw">aes</span>(<span class="dt">label =</span>  <span class="kw">paste</span>(..eq.label.., ..adj.rr.label.., <span class="dt">sep =</span> <span class="st">&quot;~~~~&quot;</span>)),</span>
<span id="cb218-13"><a href="regressões.html#cb218-13"></a>               <span class="dt">formula =</span> <span class="st">&quot;y~x&quot;</span>, <span class="dt">parse =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-52-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Admito que não sei usar as funções deste pacote então recomendo que quem estiver lendo estas informaçõs busque outras fontes de conteúdo.
A <a href="https://github.com/cran/ggpmisc">página</a> do desenvolvedor contém várias informações e exemplos.</p>
</div>
<div id="método-ggpubr" class="section level4" number="6.1.1.4">
<h4><span class="header-section-number">6.1.1.4</span> Método <code>ggpubr</code></h4>
<p>Provavelmente este é o método mais simples para gerar gráficos de regressão linear para uma curva de calibração.
O pacote é outra extensão do <code>ggplot2</code> e foi feito para facilitar a construção de <em>plots</em> comuns no meio científico.
A <a href="https://rpkgs.datanovia.com/ggpubr/index.html">página</a> possui vários exemplos e a documentação necessária para criação dos gráficos.</p>
<p>O <code>ggpubr</code> é uma ferramenta que facilita bastante o uso do <code>R</code> para construção de gráficos, porém com algumas desvantagens e limitaçòes de customização.
A sintaxe é um pouco diferente do <code>ggplot</code> mas similar o suficiente para não criar uma barreira para o usuário.</p>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="regressões.html#cb219-1"></a><span class="kw">library</span>(ggpubr)</span>
<span id="cb219-2"><a href="regressões.html#cb219-2"></a></span>
<span id="cb219-3"><a href="regressões.html#cb219-3"></a>ggpubr &lt;-<span class="st"> </span><span class="kw">ggscatter</span>(calibracao,</span>
<span id="cb219-4"><a href="regressões.html#cb219-4"></a>                    <span class="dt">x =</span> <span class="st">&quot;conc&quot;</span>,</span>
<span id="cb219-5"><a href="regressões.html#cb219-5"></a>                    <span class="dt">y =</span> <span class="st">&quot;abs&quot;</span>,</span>
<span id="cb219-6"><a href="regressões.html#cb219-6"></a>                    <span class="dt">add =</span> <span class="st">&quot;reg.line&quot;</span>) <span class="op">+</span></span>
<span id="cb219-7"><a href="regressões.html#cb219-7"></a><span class="st">    </span><span class="kw">stat_cor</span>(<span class="dt">label.x =</span> <span class="dv">5</span>, <span class="dt">label.y =</span> <span class="dv">36</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb219-8"><a href="regressões.html#cb219-8"></a><span class="st">    </span><span class="kw">stat_regline_equation</span>(<span class="dt">label.x =</span> <span class="dv">5</span>, <span class="dt">label.y =</span> <span class="dv">40</span>) <span class="op">+</span></span>
<span id="cb219-9"><a href="regressões.html#cb219-9"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Criado com ggpubr&quot;</span>)</span>
<span id="cb219-10"><a href="regressões.html#cb219-10"></a></span>
<span id="cb219-11"><a href="regressões.html#cb219-11"></a>ggpubr</span></code></pre></div>
<p><img src="_main_files/figure-html/unnamed-chunk-53-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Alternativamente as funções do <code>ggpubr</code> podem ser usadas em <em>plots</em> criados com o <code>ggplot2</code> porque os objetos criados pelos dois tem compatibilidades.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="regressões.html#cb220-1"></a>gg &lt;-<span class="st"> </span><span class="kw">ggplot</span>(calibracao,</span>
<span id="cb220-2"><a href="regressões.html#cb220-2"></a>             <span class="kw">aes</span>(</span>
<span id="cb220-3"><a href="regressões.html#cb220-3"></a>                <span class="dt">x =</span> conc,</span>
<span id="cb220-4"><a href="regressões.html#cb220-4"></a>                <span class="dt">y =</span> abs</span>
<span id="cb220-5"><a href="regressões.html#cb220-5"></a>             )) <span class="op">+</span></span>
<span id="cb220-6"><a href="regressões.html#cb220-6"></a><span class="st">    </span><span class="kw">geom_smooth</span>(<span class="dt">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="dt">se =</span> <span class="ot">FALSE</span>, <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>, <span class="dt">formula =</span> <span class="st">&quot;y ~ x&quot;</span>) <span class="op">+</span></span>
<span id="cb220-7"><a href="regressões.html#cb220-7"></a><span class="st">    </span><span class="kw">geom_point</span>() <span class="op">+</span></span>
<span id="cb220-8"><a href="regressões.html#cb220-8"></a><span class="st">    </span><span class="kw">stat_cor</span>(<span class="dt">label.x =</span> <span class="dv">5</span>, <span class="dt">label.y =</span> <span class="dv">36</span>) <span class="op">+</span><span class="st"> </span></span>
<span id="cb220-9"><a href="regressões.html#cb220-9"></a><span class="st">    </span><span class="kw">stat_regline_equation</span>(<span class="dt">label.x =</span> <span class="dv">5</span>, <span class="dt">label.y =</span> <span class="dv">40</span>) <span class="op">+</span></span>
<span id="cb220-10"><a href="regressões.html#cb220-10"></a><span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&quot;Criado com ggplot2 + ggpubr&quot;</span>)</span>
<span id="cb220-11"><a href="regressões.html#cb220-11"></a></span>
<span id="cb220-12"><a href="regressões.html#cb220-12"></a></span>
<span id="cb220-13"><a href="regressões.html#cb220-13"></a><span class="co"># usando patchwork</span></span>
<span id="cb220-14"><a href="regressões.html#cb220-14"></a>ggpubr <span class="op">+</span><span class="st"> </span>gg</span></code></pre></div>
<pre><code>`geom_smooth()` using formula &#39;y ~ x&#39;</code></pre>
<p><img src="_main_files/figure-html/unnamed-chunk-54-1.png" width="2100" style="display: block; margin: auto;" /></p>
<p>Existe uma infinidade de formas de mostrar estes dados, o importante é achar a forma que melhor atende suas necessidades e que seja o mais fácil criar.</p>
<hr />
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="tutoriais.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="smoothing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="assets/gitbook-2.6.7/js/app.min.js"></script>
<script src="assets/gitbook-2.6.7/js/lunr.js"></script>
<script src="assets/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="assets/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="assets/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"toolbar": {
"position": "static"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
